(self.webpackChunksakurairo_scripts=self.webpackChunksakurairo_scripts||[]).push([[48],{3048:function(t,e,r){r.r(e);class i{constructor(t){this.key=t,this.pull()}pull(){let t=window.history.state,e=null==t?void 0:t[this.key];if(void 0===e||this.index!==e){var r=window.sessionStorage.getItem(this.key),i=r?JSON.parse(r):[];i[this.index]=this.state,window.sessionStorage.setItem(this.key,JSON.stringify(i)),void 0===e?(this.index=i.length,this.state=null,window.history.replaceState({...t,[this.key]:this.index},document.title)):(this.index=e,this.state=r?i[e]:null)}}}let o=(t,e)=>{t.replaceWith(e)},s={default:o,innerHTML:(t,e)=>{t.innerHTML=e.innerHTML},textContent:(t,e)=>{t.textContent=e.textContent},innerText:(t,e)=>{t.innerText=e.innerText},attributes:(t,e)=>{let r=t.getAttributeNames();e.getAttributeNames().forEach((i=>{t.setAttribute(i,e.getAttribute(i)||""),r=r.filter((t=>t!==i))})),r.forEach((e=>{t.removeAttribute(e)}))},replaceWith:o};class n{constructor(t,e){this.form=t,this.submitButton=e}getAttribute(t){let{submitButton:e,form:r}=this;if(e&&e.hasAttribute(`form${t}`)){var i=`${t.charAt(0).toUpperCase()}${t.slice(1)}`;if(i=e[`form${i}`])return i}return r[t]}getEntryList(){let{form:t,submitButton:e}=this,r=new FormData(t);return e&&!e.disabled&&e.name&&r.append(e.name,e.value),r}getNameValuePairs(){return Array.from(this.getEntryList(),(([t,e])=>[t,e instanceof File?e.name:e]))}getURLSearchParams(){return new URLSearchParams(this.getNameValuePairs())}getTextPlain(){return this.getNameValuePairs().reduce(((t,[e,r])=>`${t}${e}=${r}\r\n`),"")}getRequestInfo(){let t=this.getAttribute("action");var e=new URL(t,document.baseURI);if(!/^https?:$/.test(e.protocol))return null;switch(this.getAttribute("method")){case"get":return e.search=this.getURLSearchParams().toString(),e.href;case"post":switch(this.getAttribute("enctype")){case"application/x-www-form-urlencoded":e=this.getURLSearchParams();break;case"multipart/form-data":e=this.getEntryList();break;case"text/plain":e=this.getTextPlain();break;default:return null}return new Request(t,{method:"POST",body:e});default:return null}}}let a=t=>{if(t===window.name)return window;switch(t.toLowerCase()){case"":case"_self":return window;case"_parent":return window.parent;case"_top":return window.top}};class l{constructor(t){this.pjax=t}test(t){let{defaultTrigger:e}=this.pjax.options;if("boolean"==typeof e)return e;let{enable:r,exclude:i}=e;return!(!1===r||i&&t.matches(i))}load(t,e){var r,i;let o={},s=null==(r=e.getAttribute("referrerpolicy"))?void 0:r.toLowerCase();void 0!==s&&(o.referrerPolicy=s),null!=(i=e.getAttribute("rel"))&&i.split(/\s+/).some((t=>"noreferrer"===t.toLowerCase()))&&(o.referrer=""),this.pjax.load(new Request(t,o)).catch((()=>{}))}onLinkOpen(t){if(!t.defaultPrevented){var{target:e}=t;if(e instanceof Element&&(e=e.closest("a[href], area[href]"))&&this.test(e)){if((t instanceof MouseEvent||t instanceof KeyboardEvent)&&(t.metaKey||t.ctrlKey||t.shiftKey||t.altKey))return;a(e.target)===window&&e.origin===window.location.origin&&(t.preventDefault(),this.load(e.href,e))}}}onFormSubmit(t){if(!t.defaultPrevented){var{target:e,submitter:r}=t;if(e instanceof HTMLFormElement&&this.test(e)){var i=new n(e,r);a(i.getAttribute("target"))===window&&(i=i.getRequestInfo())&&new URL("string"==typeof i?i:i.url).origin===window.location.origin&&(t.preventDefault(),this.load(i,e))}}}register(){document.addEventListener("click",(t=>{this.onLinkOpen(t)})),document.addEventListener("keyup",(t=>{"Enter"===t.key&&this.onLinkOpen(t)})),"SubmitEvent"in window&&document.addEventListener("submit",(t=>{this.onFormSubmit(t)}))}}async function c(t,e={}){var r,i;let o,{selectors:n,switches:a,cache:l,timeout:c,hooks:h}={...this.options,...e},u={},d=(null==(r=this.abortController)?void 0:r.signal)||null;u.signal=d,r={cache:l,signal:d},t instanceof Request&&(r.referrer=t.referrer,r.referrerPolicy=t.referrerPolicy),(t=new Request(t,r)).headers.set("X-Requested-With","Fetch"),t.headers.set("X-Pjax","true"),t.headers.set("X-Pjax-Selectors",JSON.stringify(n)),t=await(null==(i=h.request)?void 0:i.call(h,t))||t,u.request=t,u.timeout=c,0<c&&(o=window.setTimeout((()=>{var t;null==(t=this.abortController)||t.abort()}),c),u.timeoutID=o),this.fire("send",u);try{var w,f,m;let r=await fetch(t).finally((()=>{window.clearTimeout(o)})),i=await(null==(w=h.response)?void 0:w.call(h,r))||r;u.response=i,this.fire("receive",u);let l=new URL(i.url);l.hash=new URL(t.url).hash,window.location.href!==l.href&&window.history.pushState(null,"",l.href);let c=(new DOMParser).parseFromString(await i.text(),"text/html"),p=await(null==(f=h.document)?void 0:f.call(h,c))||c;u.switches=a;let b=await async function(t,{selectors:e,switches:r,signal:i=null}){if(null!=i&&i.aborted)throw new DOMException("Aborted switches","AbortError");let o=!1,n=[];return e.forEach((e=>{let i=t.querySelectorAll(e),a=document.querySelectorAll(e);if(i.length!==a.length)throw new DOMException(`Selector '${e}' does not select the same amount of nodes`,"IndexSizeError");let{activeElement:l}=document;a.forEach(((t,a)=>{!o&&l&&t.contains(l)&&((l instanceof HTMLElement||l instanceof SVGElement)&&l.blur(),o=!0);let c=(null==r?void 0:r[e])||s.default,h=Promise.resolve().then((()=>c(t,i[a]))).catch((()=>{}));n.push(h)}))})),await Promise.race([Promise.all(n),new Promise(((t,e)=>{null==i||i.addEventListener("abort",(()=>{e(new DOMException("Aborted switches","AbortError"))}))}))]),{focusCleared:o}}(p,{selectors:n,switches:a,signal:d}),g=await(null==(m=h.switchesResult)?void 0:m.call(h,b))||b;u.switchesResult=g,await this.preparePage(g,e)}catch(t){throw u.error=t,this.fire("error",u),t}finally{this.fire("complete",u)}this.fire("success",u)}let h=/^((application|text)\/(x-)?(ecma|java)script|text\/(javascript1\.[0-5]|(j|live)script))$/;class u{constructor(t){if(this.evaluable=this.blocking=this.external=!1,this.target=t,t.hasAttribute("src")||t.text){var e=t.type?t.type.trim().toLowerCase():"text/javascript";if(h.test(e))this.type="classic";else{if("module"!==e)return;this.type="module"}t.noModule&&"classic"===this.type||(t.src&&(this.external=!0),this.blocking=!0,("classic"!==this.type||this.external&&(t.hasAttribute("async")||t.defer))&&(this.blocking=!1),this.evaluable=!0)}}eval(){return new Promise(((t,e)=>{let r=this.target,i=document.createElement("script");i.addEventListener("error",e),i.async=!1,r.getAttributeNames().forEach((t=>{i.setAttribute(t,r.getAttribute(t)||"")})),i.text=r.text,document.contains(r)?r.replaceWith(i):(document.head.append(i),this.external?i.addEventListener("load",(()=>i.remove())):i.remove()),this.external?i.addEventListener("load",(()=>t())):t()}))}}class d{constructor(t){this.signal=t}async exec(t){var e;if(null!=(e=this.signal)&&e.aborted)throw new DOMException("Execution aborted","AbortError");e=t.eval().catch((()=>{})),t.blocking&&await e}}async function w(t,e={}){if(e={...this.options,...e},t){var r;if(t.focusCleared){let t=document.querySelectorAll("[autofocus]")[0];(t instanceof HTMLElement||t instanceof SVGElement)&&t.focus()}let i=[];e.scripts&&document.querySelectorAll(e.scripts).forEach((t=>{t instanceof HTMLScriptElement&&i.push(t)})),e.selectors.forEach((t=>{document.querySelectorAll(t).forEach((t=>{t instanceof HTMLScriptElement?i.push(t):t.querySelectorAll("script").forEach((t=>{i.includes(t)||i.push(t)}))}))})),i.sort(((t,e)=>t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING||-1)),await async function(t,{signal:e=null}={}){if(null!=e&&e.aborted)throw new DOMException("Aborted execution","AbortError");t=Array.from(t,(t=>new u(t))).filter((t=>t.evaluable));let r=new d(e);t=t.reduce(((t,e)=>e.external?Promise.all([t,r.exec(e)]):t.then((()=>r.exec(e)))),Promise.resolve()),await Promise.race([t,new Promise(((t,r)=>{null==e||e.addEventListener("abort",(()=>{r(new DOMException("Aborted execution","AbortError"))}))}))])}(i,{signal:(null==(r=this.abortController)?void 0:r.signal)||null})}({scrollTo:r}=e),!1!==r&&(t=!!t&&[0,0],Array.isArray(r)?t=r:"number"==typeof r?t=[window.scrollX,r]:(r=(()=>{let t=null;const e=decodeURIComponent(window.location.hash.slice(1));return e&&(t=document.getElementById(e)||document.getElementsByName(e)[0]),t||e&&"top"!==e.toLowerCase()||(t=document.scrollingElement),t})())&&(r.scrollIntoView(),t=!1),t&&window.scrollTo(t[0],t[1]))}async function f(t,e={}){var r;this.storeHistory();let i=new AbortController;null==(r=this.abortController)||r.abort(),this.abortController=i,(r=new URL("string"==typeof t?t:t.url,document.baseURI)).pathname+r.search===this.location.pathname+this.location.search&&r.href.includes("#")?(window.location.hash!==r.hash&&window.history.pushState(null,"",r.href),await this.preparePage(null,e)):await this.switchDOM(t,e),this.history.pull(),this.location.href=window.location.href,this.abortController=null}class m{static reload(){window.location.reload()}constructor(t={}){this.options={defaultTrigger:!0,selectors:["title",".pjax"],switches:{},scripts:"script[data-pjax]",scrollTo:!0,scrollRestoration:!0,cache:"default",timeout:0,hooks:{}},this.history=new i("pjax"),this.location=new URL(window.location.href),this.abortController=null,this.switchDOM=c,this.preparePage=w,this.weakLoad=f,Object.assign(this.options,t),this.options.scrollRestoration&&(window.history.scrollRestoration="manual",window.addEventListener("beforeunload",(()=>{window.history.scrollRestoration="auto"}))),({defaultTrigger:t}=this.options),(!0===t||!1!==t&&!1!==t.enable)&&new l(this).register(),window.addEventListener("popstate",(t=>{this.storeHistory(),this.history.pull(),null!==t.state&&(t={},this.options.scrollRestoration&&this.history.state&&(t.scrollTo=this.history.state.scrollPos),this.load(window.location.href,t).catch((()=>{})))}))}storeHistory(){this.history.state={scrollPos:[window.scrollX,window.scrollY]}}fire(t,e){t=new CustomEvent(`pjax:${t}`,{bubbles:!0,cancelable:!1,detail:{abortController:this.abortController,...e}}),document.dispatchEvent(t)}async load(t,e={}){try{await this.weakLoad(t,e)}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)throw e;window.location.assign("string"==typeof t?t:t.url)}}}m.switches=s,e.default=m}}]);
//# sourceMappingURL=48.js.map